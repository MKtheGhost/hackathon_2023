<!DOCTYPE html>
<html>
<head>
    <title>Jeux des cartes mystères</title>
    <style>
		body{
			font-family:cursive;
		}
        #game {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        #cards {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        .card {
            width: 100px;
            height: 150px;
            border: None;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        #result {
            margin-top: 20px;
            font-weight: bold;
        }
        #score {
            margin-top: 10px;
        }
        #characters {
            display: flex;
			width:100%;
            justify-content: center;
            gap: 10px;
            margin-top: 0px;
			margin-bottom:10px;
        }
		
		.joueur {
			margin-left:1%;
		}
		
		.boss {
			margin-left:1%;
		}
		
        .character img {
            width: 150px;
            height: 150px;
        }

        .card img {
            width: 100%;
            height: 100%;
        }
		
		.card.grayed-out {
			background-color: gray;
		}
		
		.health-bar-player {
            font-weight: bold;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 150px;
            height: 20px;
            border: 1px solid black;
			margin-right:500px;
        }

        .health-bar-player span {
            display: inline-block;
            width: 100%;
            height: 100%;
            background-color: green;
            transition: width 0.3s ease-in-out;
        }
		
		.health-bar-boss {
            font-weight: bold;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 150px;
            height: 20px;
            border: 1px solid black;
        }

        .health-bar-boss span {
            display: inline-block;
            width: 100%;
            height: 100%;
            background-color: red;
            transition: width 0.3s ease-in-out;
        }
		
		.red-dot {
			position: absolute;
			width: 10px;
			height: 10px;
			background-color: red;
			border-radius: 50%;
			transition: all 1s ease-in-out;
		}
    </style>
</head>
<body>
    <center><h1 style="font-size:20px">Jeux des cartes mystères</h1></center>

    <div id="characters" style="float:left; width:100%; background-image:url('fonds/mini_jeu.PNG'); background-size:cover;">
		<!-- <img src="fonds/mini_jeu.PNG"> -->
        <div class="character">
		<div id="player-health" class="health-bar-player"><span id="player-score">10</span></div>		
            <img src="personnages/joueur.png" class="joueur" alt="Joueur">
        </div>

        <div class="character">
		<div id="boss-health" class="health-bar-boss"><span id="boss-score">10</span></div>
            <img src="personnages/boss1.png" class="boss" alt="Boss">
        </div>
    </div>

    <div id="game" style="float:right; width:70%">
        <div id="cards"></div>
        
    </div>

    <div id="affirmation-frame" style="margin-left:1.5%">
        <br>
        <h2>Affirmations :</h2>
		<div id="result"></div>
        <p id="affirmation"></p>
        <input type="text" id="eventName" placeholder="Nom de l'événement">
		<button id="validate-button" onclick="validateEventName()">Valider</button>
        <button id="show-button" onclick="displayRandomAffirmation()">Afficher une autre affirmation</button>
		<div id="score"></div>
    </div>

    <script>
        // Liste des 50 cartes possibles avec leurs affirmations
        const cards = [
            { imageUrl: "cartes/1.png", eventName:"1", affirmations: ["Affirmation 1", "Affirmation 2"] },
            { imageUrl: "cartes/2.png", eventName:"2", affirmations: ["Affirmation 3", "Affirmation 4"] },
            { imageUrl: "cartes/3.png", eventName:"3", affirmations: ["Affirmation 5", "Affirmation 6"] },
            { imageUrl: "cartes/4.png", eventName:"4", affirmations: ["Affirmation 7", "Affirmation 8"] },
            { imageUrl: "cartes/5.png", eventName:"5", affirmations: ["Affirmation 9", "Affirmation 10"] },
            { imageUrl: "cartes/6.png", eventName:"6", affirmations: ["Affirmation 11", "Affirmation 12"] },
            { imageUrl: "cartes/7.png", eventName:"7", affirmations: ["Affirmation 13", "Affirmation 14"] },
            { imageUrl: "cartes/8.png", eventName:"8", affirmations: ["Affirmation 15", "Affirmation 16"] },
            { imageUrl: "cartes/9.png", eventName:"9", affirmations: ["Affirmation 17", "Affirmation 18"] },
            { imageUrl: "cartes/10.png", eventName:"10", affirmations: ["Affirmation 19", "Affirmation 20"] },
            { imageUrl: "cartes/11.png", eventName:"11", affirmations: ["Affirmation 21", "Affirmation 22"] },
            { imageUrl: "cartes/12.png", eventName:"12", affirmations: ["Affirmation 23", "Affirmation 24"] },
            { imageUrl: "cartes/13.png", eventName:"13", affirmations: ["Affirmation 25", "Affirmation 26"] },
            { imageUrl: "cartes/14.png", eventName:"14", affirmations: ["Affirmation 27", "Affirmation 28"] },
            { imageUrl: "cartes/15.png", eventName:"15", affirmations: ["Affirmation 29", "Affirmation 30"] },
            { imageUrl: "cartes/16.png", eventName:"16", affirmations: ["Affirmation 31", "Affirmation 32"] },
            { imageUrl: "cartes/17.png", eventName:"17", affirmations: ["Affirmation 33", "Affirmation 34"] },
            { imageUrl: "cartes/18.png", eventName:"18", affirmations: ["Affirmation 35", "Affirmation 36"] },
            { imageUrl: "cartes/19.png", eventName:"19", affirmations: ["Affirmation 37", "Affirmation 38"] },
            { imageUrl: "cartes/20.png", eventName:"20", affirmations: ["Affirmation 39", "Affirmation 40"] },
            { imageUrl: "cartes/21.png", eventName:"21", affirmations: ["Affirmation 41", "Affirmation 42"] },
            { imageUrl: "cartes/22.png", eventName:"22", affirmations: ["Affirmation 43", "Affirmation 44"] },
            { imageUrl: "cartes/23.png", eventName:"23", affirmations: ["Affirmation 45", "Affirmation 46"] },
            { imageUrl: "cartes/24.png", eventName:"24", affirmations: ["Affirmation 47", "Affirmation 48"] },
            { imageUrl: "cartes/25.png", eventName:"25", affirmations: ["Affirmation 49", "Affirmation 50"] },
            { imageUrl: "cartes/26.png", eventName:"26", affirmations: ["Affirmation 51", "Affirmation 52"] },
            { imageUrl: "cartes/27.png", eventName:"27", affirmations: ["Affirmation 53", "Affirmation 54"] },
            { imageUrl: "cartes/28.png", eventName:"28", affirmations: ["Affirmation 55", "Affirmation 56"] },
            { imageUrl: "cartes/29.png", eventName:"29", affirmations: ["Affirmation 57", "Affirmation 58"] },
            { imageUrl: "cartes/30.png", eventName:"30", affirmations: ["Affirmation 59", "Affirmation 60"] },
            { imageUrl: "cartes/31.png", eventName:"31", affirmations: ["Affirmation 61", "Affirmation 62"] },
            { imageUrl: "cartes/32.png", eventName:"32", affirmations: ["Affirmation 63", "Affirmation 64"] },
            { imageUrl: "cartes/33.png", eventName:"33", affirmations: ["Affirmation 65", "Affirmation 66"] },
            { imageUrl: "cartes/34.png", eventName:"34", affirmations: ["Affirmation 67", "Affirmation 68"] },
            { imageUrl: "cartes/35.png", eventName:"35", affirmations: ["Affirmation 69", "Affirmation 70"] },
            { imageUrl: "cartes/36.png", eventName:"36", affirmations: ["Affirmation 71", "Affirmation 72"] },
            { imageUrl: "cartes/37.png", eventName:"37", affirmations: ["Affirmation 73", "Affirmation 74"] },
            { imageUrl: "cartes/38.png", eventName:"38", affirmations: ["Affirmation 75", "Affirmation 76"] },
            { imageUrl: "cartes/39.png", eventName:"39", affirmations: ["Affirmation 77", "Affirmation 78"] },
            { imageUrl: "cartes/40.png", eventName:"40", affirmations: ["Affirmation 79", "Affirmation 80"] },
            { imageUrl: "cartes/41.png", eventName:"41", affirmations: ["Affirmation 81", "Affirmation 82"] },
            { imageUrl: "cartes/42.png", eventName:"42", affirmations: ["Affirmation 83", "Affirmation 84"] },
            { imageUrl: "cartes/43.png", eventName:"43", affirmations: ["Affirmation 85", "Affirmation 86"] },
            { imageUrl: "cartes/44.png", eventName:"44", affirmations: ["Affirmation 87", "Affirmation 88"] },
            { imageUrl: "cartes/45.png", eventName:"45", affirmations: ["Affirmation 89", "Affirmation 90"] },
            { imageUrl: "cartes/46.png", eventName:"46", affirmations: ["Affirmation 91", "Affirmation 92"] },
            { imageUrl: "cartes/47.png", eventName:"47", affirmations: ["Affirmation 93", "Affirmation 94"] },
            { imageUrl: "cartes/48.png", eventName:"48", affirmations: ["Affirmation 95", "Affirmation 96"] },
            { imageUrl: "cartes/49.png", eventName:"49", affirmations: ["Affirmation 97", "Affirmation 98"] },
            { imageUrl: "cartes/50.png", eventName:"50", affirmations: ["Affirmation 99", "Affirmation 100"] },
        ];

        // Liste des affirmations affichées
        let displayedAffirmations = [];
		
		// Initialiser les scores boss et player
		let playerScore = 10;
		let bossScore = 10;

        // Sélectionne une affirmation aléatoire parmi les affirmations disponibles pour une carte donnée
        function getRandomAffirmation(card) {
            const availableAffirmations = card.affirmations.filter(affirmation => !displayedAffirmations.includes(affirmation));
            const randomIndex = Math.floor(Math.random() * availableAffirmations.length);
            return availableAffirmations[randomIndex];
        }

        // Affiche une affirmation aléatoire dans le cadre
        function displayRandomAffirmation() {
            const affirmationElement = document.getElementById("affirmation");
            const showButtonElement = document.getElementById("show-button");
            const selectedCard = selectedCards[Math.floor(Math.random() * selectedCards.length)];
            let newAffirmation = getRandomAffirmation(selectedCard);

            // Vérifie si l'affirmation sélectionnée a déjà été affichée
            while (displayedAffirmations.includes(newAffirmation)) {
                // Sélectionne une nouvelle affirmation aléatoire
                newAffirmation = getRandomAffirmation(selectedCard);
            }

            // Ajoute la nouvelle affirmation à la liste des affirmations affichées
            displayedAffirmations.push(newAffirmation);

            // Met à jour le contenu du cadre avec toutes les affirmations affichées
            affirmationElement.innerHTML = displayedAffirmations.join("<br>");

            // Fait défiler jusqu'en bas pour afficher la dernière affirmation
            affirmationElement.scrollTop = affirmationElement.scrollHeight;

            // Vérifie si le nombre maximal d'affirmations est atteint
            if (displayedAffirmations.length >= 10) {
                showButtonElement.disabled = true;
            }
			
			// Diminue le score du joueur de 1
            score--;

			const bossElement = document.querySelector(".boss");
			const playerElement = document.querySelector(".joueur");
			const redDot = document.createElement("div");
			redDot.className = "red-dot";
			document.body.appendChild(redDot);

			const bossPosition = bossElement.getBoundingClientRect();
			const playerPosition = playerElement.getBoundingClientRect();
			const dotPosition = {
				top: bossPosition.top + bossPosition.height / 2 - redDot.offsetHeight / 2,
				left: bossPosition.left + bossPosition.width / 2 - redDot.offsetWidth / 2
			};
			redDot.style.top = dotPosition.top + "px";
			redDot.style.left = dotPosition.left + "px";

			setTimeout(() => {
				redDot.style.top = playerPosition.top + playerPosition.height / 2 - redDot.offsetHeight / 2 + "px";
				redDot.style.left = playerPosition.left + playerPosition.width / 2 - redDot.offsetWidth / 2 + "px";
				setTimeout(() => {
					redDot.remove();
					playerScoreElement.textContent = score;
					if (score === 0) {
						displayResult(`Dommage ! Vous avez perdu la partie, l'événement était : ${mysteryCard.eventName}`);
					}
				}, 1000);
			}, 10);

			const playerScoreElement = document.getElementById("player-score");
				playerScoreElement.textContent = score;
            updateScore();
			// Vérifie si le joueur a perdu
			if (score === 0) {
				displayResult(`Dommage ! Vous avez perdu la partie, l'événement était : ${mysteryCard.eventName}`);
			}
        }
		
		// Fonction pour valider le nom de l'évènement
		function validateEventName() {
			const eventNameElement = document.getElementById("eventName");
			const eventName = eventNameElement.value.trim(); // Récupère la valeur saisie et supprime les espaces en début et fin de chaîne

			// Vérifie si la réponse est correcte
			if (eventName.toLowerCase() === mysteryCard.eventName.toLowerCase()) {
				displayResult("Gagné !");
			} else {
				displayResult("Perdu !");
			}
		}

        // Niveau de difficulté du jeu (1, 2 ou 3)
        const difficultyLevel = 1;

        // Nombre de cartes à sélectionner pour le jeu
        const numCards = 15;

        // Carte mystère à deviner
        let mysteryCard;

        // Cartes sélectionnées pour le jeu
        let selectedCards = [];

        // Score du joueur
        let score = 10;

        // Sélectionne les cartes pour le jeu
        function selectCards() {
            // Réinitialise les cartes sélectionnées
            selectedCards = [];

            // Sélectionne les cartes au hasard
            let availableCards = cards.slice(); // Copie de la liste des cartes
            for (let i = 0; i < numCards; i++) {
                const randomIndex = Math.floor(Math.random() * availableCards.length);
                const selectedCard = availableCards.splice(randomIndex, 1)[0];
                selectedCards.push(selectedCard);
            }

            // Choisis une carte mystère parmi les cartes sélectionnées
            mysteryCard = selectedCards[Math.floor(Math.random() * selectedCards.length)];

            // Affiche les cartes sur le plateau de jeu
            displayCards();
        }

        // Affiche les cartes sur le plateau de jeu
        function displayCards() {
            const cardsElement = document.getElementById("cards");
            cardsElement.innerHTML = "";

            for (let i = 0; i < selectedCards.length; i++) {
                const card = selectedCards[i];

                const cardElement = document.createElement("div");
                cardElement.className = "card";

                const imageElement = document.createElement("img");
                imageElement.src = card.imageUrl; // Utilisez la propriété imageUrl de la carte
                imageElement.setAttribute("alt", "Carte"); // Ajoutez l'attribut alt pour l'accessibilité
                imageElement.style.width = "100%"; // Ajuste la largeur de l'image à 100% de la carte

                cardElement.appendChild(imageElement);

				// Ajoute un gestionnaire d'événements de clic à chaque carte
				cardElement.addEventListener("click", function() {
					changeImage(imageElement);
					checkGuess(card);
				});
				
				cardElement.appendChild(imageElement);
                cardsElement.appendChild(cardElement);
            }
        }
		
		// Change l'image par une nouvelle image
		function changeImage(imageElement) {
			imageElement.src = "cartes/dos.png";
		}
		
        // Affiche le résultat de la partie
        function displayResult(message) {
            const resultElement = document.getElementById("result");
            resultElement.textContent = message;

            // Désactive les cartes pour empêcher le joueur de continuer à jouer
            const cardsElement = document.getElementById("cards");
            cardsElement.style.pointerEvents = "none";
        }

        // Met à jour le score du joueur
        function updateScore() {
            const scoreElement = document.getElementById("score");
            scoreElement.textContent = `Score : ${score}`;
        }

        // Initialise le jeu
        function initializeGame() {
            // Réinitialise les affirmations affichées et le score
            displayedAffirmations = [];
            score = 10;

            // Réactive les cartes pour permettre au joueur de jouer à nouveau
            const cardsElement = document.getElementById("cards");
            cardsElement.style.pointerEvents = "auto";

            // Affiche les cartes et sélectionne une carte mystère
            selectCards();

            // Réinitialise le résultat et le score affichés
            const resultElement = document.getElementById("result");
            resultElement.textContent = "";

            updateScore();
        }

        // Initialise le jeu au chargement de la page
        window.onload = initializeGame;
    </script>
</body>
</html>
